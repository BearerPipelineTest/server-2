/*! For license information please see profiler-profilerToolbar.js.LICENSE.txt */
!function(){"use strict";var n,e={71037:function(n,e,o){var r=o(20144),i=o(16453),a=o(20629),l=o(79753);function c(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var o,r,i=[],a=!0,l=!1;try{for(e=e.call(t);!(a=(o=e.next()).done)&&(i.push(o.value),!n||i.length!==n);a=!0);}catch(t){l=!0,r=t}finally{try{a||null==e.return||e.return()}finally{if(l)throw r}}return i}}(t,n)||function(t,n){if(t){if("string"==typeof t)return s(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?s(t,n):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,o=new Array(n);e<n;e++)o[e]=t[e];return o}function u(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,o)}return e}function d(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}var f=(0,i.loadState)("profiler","request-token"),A={name:"ProfilerToolbar",data:function(){return{token:f,open:!0}},computed:function(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?u(Object(e),!0).forEach((function(n){d(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):u(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}({profile:function(){return this.profiles[this.token]},queriesNumber:function(){return Object.values(this.profile.collectors.db.queries).length},queriesTime:function(){return(1e3*Object.values(this.profile.collectors.db.queries).reduce((function(t,n){return n.executionMS+t}),0)).toFixed(1)},ldapQueryTime:function(){return(1e3*Object.values(this.profile.collectors.ldap).reduce((function(t,n){return n.end-n.start+t}),0)).toFixed(1)},cacheTotal:function(){var t=0;return Object.entries(this.profile.collectors).forEach((function(n){var e=c(n,2),o=e[0],r=e[1];o.includes("cache")&&(t+=r.cacheMiss+r.cacheHit)})),t},cacheHits:function(){var t=0;return Object.entries(this.profile.collectors).forEach((function(n){var e=c(n,2),o=e[0],r=e[1];o.includes("cache")&&(t+=r.cacheHit)})),t},cacheTime:function(){var t=0;return Object.entries(this.profile.collectors).forEach((function(n){var e=c(n,2),o=e[0],r=e[1];o.includes("cache")&&(t+=r.queries.reduce((function(t,n){return n.end-n.start+t}),0))})),(1e3*t).toFixed(1)},background:function(){return this.profile?200===this.profile.statusCode?"status-success":500===this.profile.statusCode?"status-error":"status-warning":""},time:function(){return this.profile?new Date(1e3*this.profile.time).toUTCString():""}},(0,a.rn)(["profiles","stackElements"])),mounted:function(){this.$store.dispatch("loadProfile",{token:f})},methods:{displayDuration:function(t){return(1e3*t).toFixed(2)},generateAjaxUrl:function(t){return(0,l.generateUrl)("/apps/profiler/profiler/db/{token}",{token:t.profile})},openProfiler:function(t){document.location=(0,l.generateUrl)("/apps/profiler/profiler/{view}/{token}",{view:t,token:this.token})}}},p=A,b=o(93379),v=o.n(b),C=o(7795),h=o.n(C),m=o(90569),g=o.n(m),_=o(3565),x=o.n(_),y=o(19216),k=o.n(y),w=o(44589),O=o.n(w),j=o(73539),P={};P.styleTagTransform=O(),P.setAttributes=x(),P.insert=g().bind(null,"head"),P.domAPI=h(),P.insertStyleElement=k(),v()(j.Z,P),j.Z&&j.Z.locals&&j.Z.locals;var D=(0,o(51900).Z)(p,(function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{attrs:{id:"profiler-toolbar"}},[t.profile?e("footer",{staticClass:"bottom-bar",class:{"bottom-bar-closed":!t.open}},[t.open?e("div",{staticClass:"toolbar-block",attrs:{role:"button"},on:{click:function(n){return t.openProfiler("http")}}},[e("div",{staticClass:"text-v-center px-3",class:t.background},[t._v("\n\t\t\t\t"+t._s(t.profile.statusCode)+"\n\t\t\t")]),t._v(" "),e("div",{staticClass:"text-v-center px-3"},[t._v("\n\t\t\t\t"+t._s(t.profile.collectors.router.controllerName)+"::"+t._s(t.profile.collectors.router.actionName)+"\n\t\t\t")]),t._v(" "),e("div",{staticClass:"info"},[e("div",[e("b",[t._v("HTTP Status:")]),t._v(" "+t._s(t.profile.statusCode)+" ")]),t._v(" "),e("div",[e("b",[t._v("Controller:")]),t._v(" "+t._s(t.profile.collectors.router.appName)+"/"+t._s(t.profile.collectors.router.controllerName)+"::"+t._s(t.profile.collectors.router.actionName)+" ")]),t._v(" "),e("div",[e("b",[t._v("Profiled on:")]),t._v(" "+t._s(t.time)+" ")]),t._v(" "),e("div",[e("b",[t._v("Token:")]),t._v(" "+t._s(t.profile.token))])])]):t._e(),t._v(" "),t.open?e("div",{staticClass:"toolbar-block text-v-center px-3",attrs:{role:"button"},on:{click:function(n){return t.openProfiler("event")}}},[t._v("\n\t\t\t"+t._s(t.displayDuration(t.profile.collectors.event.runtime.duration+t.profile.collectors.event.autoloader.duration))+" ms\n\t\t\t"),e("div",{staticClass:"info",staticStyle:{width:"225px"}},[e("div",[e("b",[t._v("Total time:")]),t._v(" "+t._s(t.displayDuration(t.profile.collectors.event.runtime.duration+t.profile.collectors.event.autoloader.duration))+" ms")]),t._v(" "),e("div",[e("b",[t._v("Boot:")]),t._v(" "+t._s(t.displayDuration(t.profile.collectors.event.boot.duration))+" ms")]),t._v(" "),t.profile.collectors.event.run_route?e("div",[e("b",[t._v("Run route:")]),t._v(" "+t._s(t.displayDuration(t.profile.collectors.event.run_route.duration))+" ms\n\t\t\t\t")]):t._e(),t._v(" "),t.profile.collectors.event.setup_fs?e("div",[e("b",[t._v("Setup filesystem:")]),t._v(" "+t._s(t.displayDuration(t.profile.collectors.event.setup_fs.duration))+" ms\n\t\t\t\t")]):t._e()])]):t._e(),t._v(" "),t.open?e("div",{staticClass:"toolbar-block text-v-center px-3",attrs:{role:"button"},on:{click:function(n){return t.openProfiler("db")}}},[t._v("\n\t\t\t"+t._s(t.queriesNumber)+" in "+t._s(t.queriesTime)+" ms\n\t\t\t"),e("div",{staticClass:"info",staticStyle:{width:"225px"}},[e("div",[e("b",[t._v("Number of queries:")]),t._v(" "+t._s(t.queriesNumber))]),t._v(" "),e("div",[e("b",[t._v("Query time:")]),t._v(" "+t._s(t.queriesTime)+" ms")])])]):t._e(),t._v(" "),t.profile.collectors.ldap&&t.open?e("div",{staticClass:"toolbar-block text-v-center px-3",attrs:{role:"button"},on:{click:function(n){return t.openProfiler("ldap")}}},[t._v("\n\t\t\t"+t._s(t.profile.collectors.ldap.length)+" LDAP request\n\t\t\t"),t.profile.collectors.ldap.length>0?e("div",{staticClass:"info",staticStyle:{width:"500px","max-height":"600px","overflow-x":"scroll"}},[e("div",[e("b",[t._v("Number of queries:")]),t._v(" "+t._s(t.profile.collectors.ldap.length))]),t._v(" "),e("div",[e("b",[t._v("Query time:")]),t._v(" "+t._s(t.ldapQueryTime)+" ms")])]):t._e()]):t._e(),t._v(" "),t.cacheTotal>0&&t.open?e("div",{staticClass:"toolbar-block text-v-center px-3",attrs:{role:"button"},on:{click:function(n){return t.openProfiler("cache")}}},[t._v("\n\t\t\t"+t._s(t.cacheHits)+" / "+t._s(t.cacheTotal)+" cache hits\n\t\t\t"),e("div",{staticClass:"info",staticStyle:{width:"200px","max-height":"600px","overflow-x":"scroll"}},[e("div",[e("b",[t._v("Cache hits:")]),t._v(" "+t._s(t.cacheHits)+" / "+t._s(t.cacheTotal))]),t._v(" "),e("div",[t._v("In "+t._s(t.cacheTime)+" ms")])])]):t._e(),t._v(" "),t.open?e("div",{staticClass:"toolbar-block text-v-center px-3",attrs:{role:"button"},on:{click:function(n){return t.openProfiler("db")}}},[t._v("\n\t\t\t"+t._s(t.stackElements.length)+" XHR requests\n\t\t\t"),e("div",{staticClass:"info",staticStyle:{width:"500px","max-height":"600px","overflow-x":"scroll"}},t._l(t.stackElements,(function(n,o){return e("div",{key:o},[e("a",{attrs:{href:t.generateAjaxUrl(n)}},[t._v("\n\t\t\t\t\t\t"+t._s(n.url)+"\n\t\t\t\t\t\tin "+t._s(n.duration.toFixed())+" ms\n\t\t\t\t\t\t"),e("span",{staticClass:"lighter"},[t._v("("+t._s(n.profile)+")")])])])})),0)]):t._e(),t._v(" "),e("div",{staticClass:"toggle-button toolbar-block text-v-center px-3",on:{click:function(n){t.open=!t.open}}},[t._v("\n\t\t   "+t._s(t.open?"Close":"Open")+"\n\t\t")])]):t._e()])}),[],!1,null,"6386a89a",null).exports,S=o(4820);r.default.use(a.ZP);var E=new a.yh({state:{profiles:{},stackElements:[]},mutations:{addProfile:function(t,n){var e=n.token,o=n.profile;r.default.set(t.profiles,e,o)},addStackElement:function(t,n){t.stackElements.push(n)}},getters:{profile:function(t){return function(n){return t.profiles[n]}}},actions:{loadProfile:function(t,n){var e=t.commit,o=t.state,r=n.token;o.profiles[r]||S.default.get((0,l.generateUrl)("/apps/profiler/profile/{token}",{token:r})).then((function(t){e("addProfile",{token:r,profile:t.data.profile})}))}}});if(r.default.prototype.OC=OC,r.default.prototype.t=t,r.default.use(a.ZP),new r.default({el:"#profiler-toolbar",store:E,render:function(t){return t(D)}}),window.fetch&&void 0===window.fetch.polyfill){var q=window.fetch;window.fetch=function(){console.debug("fetch");var t=q.apply(this,arguments),n=arguments[0],e=arguments[1],o=Object.prototype.toString.call(arguments[0]);if("[object Request]"===o?(n=arguments[0].url,e={method:arguments[0].method,credentials:arguments[0].credentials,headers:arguments[0].headers,mode:arguments[0].mode,redirect:arguments[0].redirect}):n=String(n),!n.match(/profiler/)){var r="GET";e&&void 0!==e.method&&(r=e.method);var i={error:!1,url:n,method:r,type:"fetch",start:new Date};t.then((function(t){i.duration=new Date-i.start,i.error=t.status<200||t.status>=400,i.statusCode=t.status,i.profile=t.headers.get("x-debug-token"),i.profilerUrl=t.headers.get("x-debug-token-link"),E.commit("addStackElement",i)}),(function(t){E.commit("addStackElement",i)}))}return t}}var T=function(t,n){var e,o=t.getAllResponseHeaders();(e=o.match(/^x-debug-token:\s+(.*)$/im))&&(n.profile=e[1]),(e=o.match(/^x-debug-token-link:\s+(.*)$/im))&&(n.profilerUrl=e[1])};if(window.XMLHttpRequest&&XMLHttpRequest.prototype.addEventListener){var B=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(t,n,e,o,r){var i=this,a=n;if("/"===n.substr(0,1)?0===n.indexOf("/index.php/")&&(a=n.substr("/index.php")):0===n.indexOf("".concat(location.protocol,"//").concat(location.hostname,"/").length)&&(a=n.substr("".concat(location.protocol,"//").concat(location.hostname,"/"))),!a.match(/profiler/)){var l={error:!1,url:n,method:t,type:"xhr",start:new Date};this.addEventListener("readystatechange",(function(){4===i.readyState&&(l.duration=new Date-l.start,l.error=i.status<200||i.status>=400,l.statusCode=i.status,T(i,l),E.commit("addStackElement",l))}),!1)}B.apply(this,Array.prototype.slice.call(arguments))}}},73539:function(t,n,e){var o=e(87537),r=e.n(o),i=e(23645),a=e.n(i)()(r());a.push([t.id,".bottom-bar[data-v-6386a89a]{position:fixed;width:100%;bottom:0;left:0;display:flex;z-index:10;flex-direction:row;background-color:#222;justify-content:start;height:36px;font-size:12px;border-bottom:1px solid var(--color-border);z-index:99999}.bottom-bar.bottom-bar-closed[data-v-6386a89a]{width:initial;right:0;left:initial}.bottom-bar>.toolbar-block[data-v-6386a89a]{height:100%}.bottom-bar>.toolbar-block[data-v-6386a89a],.bottom-bar>.toolbar-block>.text-v-center[data-v-6386a89a]{cursor:pointer}.bottom-bar .pr-3[data-v-6386a89a],.bottom-bar .px-3[data-v-6386a89a]{padding-right:1rem !important}.bottom-bar .pl-3[data-v-6386a89a],.bottom-bar .px-3[data-v-6386a89a]{padding-left:1rem !important}.bottom-bar .lighter[data-v-6386a89a]{color:#ddd}.bottom-bar .text-v-center[data-v-6386a89a]{height:100%;display:flex;flex-direction:column;align-items:center;justify-content:center}.bottom-bar .toolbar-block[data-v-6386a89a]:hover{position:relative;background-color:#444;border-radius:0}.bottom-bar .toolbar-block:hover .info[data-v-6386a89a]{display:block;padding:10px;max-width:480px;max-height:480px;word-wrap:break-word;overflow:hidden}.bottom-bar .toolbar-block[data-v-6386a89a]{display:flex;flex-direction:row;justify-content:center;color:#fff}.bottom-bar .toolbar-block .info[data-v-6386a89a]{background-color:#444;bottom:36px;color:#f5f5f5;display:none;padding:.5rem;position:absolute}.bottom-bar .toolbar-block .info a[data-v-6386a89a]{color:#f5f5f5}.status-success[data-v-6386a89a]{background-color:rgba(112,196,137,.75)}.status-error[data-v-6386a89a]{background-color:rgba(231,55,51,.65)}.status-warning[data-v-6386a89a]{background-color:rgba(213,118,41,.75)}.url[data-v-6386a89a]{margin-left:48px}.toggle-button[data-v-6386a89a]{margin-left:auto}","",{version:3,sources:["webpack://./apps/profiler/src/ProfilerToolbar.vue"],names:[],mappings:"AAqLA,6BACC,cAAA,CACA,UAAA,CACA,QAAA,CACA,MAAA,CACA,YAAA,CACA,UAAA,CACA,kBAAA,CACA,qBAAA,CACA,qBAAA,CACA,WAAA,CACA,cAAA,CACA,2CAAA,CACA,aAAA,CAEA,+CACC,aAAA,CACA,OAAA,CACA,YAAA,CAGD,4CACC,WAAA,CACA,uGACC,cAAA,CAIF,sEACC,6BAAA,CAGD,sEACC,4BAAA,CAGD,sCACC,UAAA,CAGD,4CACC,WAAA,CACA,YAAA,CACA,qBAAA,CACA,kBAAA,CACA,sBAAA,CAGD,kDACC,iBAAA,CACA,qBAAA,CACA,eAAA,CACA,wDACC,aAAA,CACA,YAAA,CACA,eAAA,CACA,gBAAA,CACA,oBAAA,CACA,eAAA,CAIF,4CACC,YAAA,CACA,kBAAA,CACA,sBAAA,CACA,UAAA,CACA,kDACC,qBAAA,CACA,WAAA,CACA,aAAA,CACA,YAAA,CACA,aAAA,CACA,iBAAA,CAEA,oDACC,aAAA,CAKJ,iCACC,sCAAA,CAED,+BACC,oCAAA,CAED,iCACC,qCAAA,CAED,sBACC,gBAAA,CAGD,gCACC,gBAAA",sourcesContent:["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.bottom-bar {\n\tposition: fixed;\n\twidth: 100%;\n\tbottom: 0;\n\tleft: 0;\n\tdisplay: flex;\n\tz-index: 10;\n\tflex-direction: row;\n\tbackground-color: #222;\n\tjustify-content: start;\n\theight: 36px;\n\tfont-size: 12px;\n\tborder-bottom: 1px solid var(--color-border);\n\tz-index: 99999;\n\n\t&.bottom-bar-closed {\n\t\twidth: initial;\n\t\tright: 0;\n\t\tleft: initial;\n\t}\n\n\t& > .toolbar-block {\n\t\theight: 100%;\n\t\t&, & > .text-v-center {\n\t\t\tcursor: pointer;\n\t\t}\n\t}\n\n\t.pr-3, .px-3 {\n\t\tpadding-right: 1rem !important;\n\t}\n\n\t.pl-3, .px-3 {\n\t\tpadding-left: 1rem !important;\n\t}\n\n\t.lighter {\n\t\tcolor: #ddd;\n\t}\n\n\t.text-v-center {\n\t\theight: 100%;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t}\n\n\t.toolbar-block:hover {\n\t\tposition: relative;\n\t\tbackground-color: #444;\n\t\tborder-radius: 0;\n\t\t.info {\n\t\t\tdisplay: block;\n\t\t\tpadding: 10px;\n\t\t\tmax-width: 480px;\n\t\t\tmax-height: 480px;\n\t\t\tword-wrap: break-word;\n\t\t\toverflow: hidden;\n\t\t}\n\t}\n\n\t.toolbar-block {\n\t\tdisplay: flex;\n\t\tflex-direction: row;\n\t\tjustify-content: center;\n\t\tcolor: white;\n\t\t.info {\n\t\t\tbackground-color: #444;\n\t\t\tbottom: 36px;\n\t\t\tcolor: #F5F5F5;\n\t\t\tdisplay: none;\n\t\t\tpadding: .5rem;\n\t\t\tposition: absolute;\n\n\t\t\ta {\n\t\t\t\tcolor: #F5F5F5;\n\t\t\t}\n\t\t}\n\t}\n}\n.status-success {\n\tbackground-color: rgba(112, 196, 137, 0.75);\n}\n.status-error {\n\tbackground-color: rgba(231, 55, 51, 0.65);\n}\n.status-warning {\n\tbackground-color: rgba(213, 118, 41, 0.75);\n}\n.url {\n\tmargin-left: 48px;\n}\n\n.toggle-button {\n\tmargin-left: auto;\n}\n"],sourceRoot:""}]),n.Z=a}},o={};function r(t){var n=o[t];if(void 0!==n)return n.exports;var i=o[t]={id:t,loaded:!1,exports:{}};return e[t].call(i.exports,i,i.exports,r),i.loaded=!0,i.exports}r.m=e,r.amdD=function(){throw new Error("define cannot be used indirect")},r.amdO={},n=[],r.O=function(t,e,o,i){if(!e){var a=1/0;for(u=0;u<n.length;u++){e=n[u][0],o=n[u][1],i=n[u][2];for(var l=!0,c=0;c<e.length;c++)(!1&i||a>=i)&&Object.keys(r.O).every((function(t){return r.O[t](e[c])}))?e.splice(c--,1):(l=!1,i<a&&(a=i));if(l){n.splice(u--,1);var s=o();void 0!==s&&(t=s)}}return t}i=i||0;for(var u=n.length;u>0&&n[u-1][2]>i;u--)n[u]=n[u-1];n[u]=[e,o,i]},r.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(n,{a:n}),n},r.d=function(t,n){for(var e in n)r.o(n,e)&&!r.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:n[e]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t},r.j=1785,function(){r.b=document.baseURI||self.location.href;var t={1785:0};r.O.j=function(n){return 0===t[n]};var n=function(n,e){var o,i,a=e[0],l=e[1],c=e[2],s=0;if(a.some((function(n){return 0!==t[n]}))){for(o in l)r.o(l,o)&&(r.m[o]=l[o]);if(c)var u=c(r)}for(n&&n(e);s<a.length;s++)i=a[s],r.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return r.O(u)},e=self.webpackChunknextcloud=self.webpackChunknextcloud||[];e.forEach(n.bind(null,0)),e.push=n.bind(null,e.push.bind(e))}();var i=r.O(void 0,[7874],(function(){return r(71037)}));i=r.O(i)}();
//# sourceMappingURL=profiler-profilerToolbar.js.map?v=4d05a64f4b9570bad78e